name: Automated Community Note Writer (Safe Test)

on:
  workflow_dispatch:

jobs:
  run-note-writer:
    runs-on: ubuntu-latest

    env:
      X_API_KEY: ${{ secrets.X_API_KEY }}
      X_API_KEY_SECRET: ${{ secrets.X_API_KEY_SECRET }}
      X_ACCESS_TOKEN: ${{ secrets.X_ACCESS_TOKEN }}
      X_ACCESS_TOKEN_SECRET: ${{ secrets.X_ACCESS_TOKEN_SECRET }}
      AUTO_SUBMIT_NOTES: "false"
      MAX_POSTS_TO_PROCESS: "1"

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Show branch and repo (debug)
        run: |
          echo "Repository: $GITHUB_REPOSITORY"
          echo "Branch: $GITHUB_REF"

      - name: Check secret presence (values not shown)
        run: |
          echo "X_API_KEY: ${X_API_KEY:+SET}"
          echo "X_API_KEY_SECRET: ${X_API_KEY_SECRET:+SET}"
          echo "X_ACCESS_TOKEN: ${X_ACCESS_TOKEN:+SET}"
          echo "X_ACCESS_TOKEN_SECRET: ${X_ACCESS_TOKEN_SECRET:+SET}"

      - name: Finish test
        run: echo "Workflow completed"
